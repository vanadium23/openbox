<!DOCTYPE html>
<html lang="ru">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" type="image/svg+xml" href="/openbox/assets/open-cardboard-box.svg">
  <link rel="stylesheet" href="/openbox/assets/css/base.css">

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Postgressql | Chernov Open üì¶</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Postgressql" />
<meta property="og:locale" content="ru_RU" />
<meta name="description" content="Snippets" />
<meta property="og:description" content="Snippets" />
<meta property="og:site_name" content="Chernov Open üì¶" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-14T06:11:13+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Postgressql" />
<meta name="twitter:site" content="@vanadium23" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-14T06:11:13+00:00","datePublished":"2022-06-14T06:11:13+00:00","description":"Snippets","headline":"Postgressql","mainEntityOfPage":{"@type":"WebPage","@id":"/openbox/postgres-sql/"},"url":"/openbox/postgres-sql/"}</script>
<!-- End Jekyll SEO tag -->

</head>

  <body>
    <nav class="u-background"><div class="u-wrapper Banner">
    <a class="Banner-link u-clickable" href="/openbox/">
        Chernov Open üì¶
    </a>
    <ul class="Banner">
        
            <li class="Banner-item">
                <a class="Banner-link u-clickable" href="/openbox/interactive-graph">–ì—Ä–∞—Ñ üåê</a>
            </li>
        
            <li class="Banner-item">
                <a class="Banner-link u-clickable" href="/openbox/search">–ü–æ–∏—Å–∫ üîç</a>
            </li>
        
    </ul>
</div>
</nav>
    <div class="container">
      <main><article>
  <header class="Heading">
    <h1 class="Heading-title">Postgressql</h1>
    <div class="Heading-additional">
      
      <time datetime="2022-06-14T06:11:13+00:00">
        –°–æ–∑–¥–∞–Ω–æ 2022-06-14
        
      </time>&middot;
      
      
      <time datetime="2023-09-29T06:23:25+00:00">
        –û–±–Ω–æ–≤–ª–µ–Ω–æ 2023-09-29
        
      </time>
      
    </div>
  </header>

  

  <div id="notes-entry-container">
    <content>
      <h2 id="snippets">Snippets</h2>

<p>—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –±–∞–∑—ã:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">create</span> <span class="k">database</span> <span class="n">mydb</span><span class="p">;</span>
<span class="k">create</span> <span class="k">user</span> <span class="n">myuser</span> <span class="k">with</span> <span class="k">encrypted</span> <span class="n">password</span> <span class="s1">'mypass'</span><span class="p">;</span>
<span class="k">grant</span> <span class="k">all</span> <span class="k">privileges</span> <span class="k">on</span> <span class="k">database</span> <span class="n">mydb</span> <span class="k">to</span> <span class="n">myuser</span><span class="p">;</span>

<span class="c1">-- –µ—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –±—ã–ª–∞, —Ç–æ –Ω–∞–¥–æ –≤—ã–¥–∞—Ç—å –µ—â—ë –∫–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º –∏ sequence, –Ω–µ –∑–∞–±—ã–≤ —Å–º–µ–Ω–∏—Ç—å –±–∞–∑—É</span>
<span class="err">\</span><span class="k">c</span> <span class="n">mydb</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="k">ALL</span> <span class="n">TABLES</span> <span class="k">IN</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">TO</span> <span class="n">my_user</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="k">ALL</span> <span class="n">SEQUENCES</span> <span class="k">IN</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">TO</span> <span class="n">my_user</span><span class="p">;</span>

<span class="c1">--- –≤—ã–¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="k">ALL</span> <span class="n">TABLES</span> <span class="k">IN</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">TO</span> <span class="k">user</span><span class="p">;</span>

<span class="c1">-- —á—Ç–æ–±—ã –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑</span>
<span class="k">ALTER</span> <span class="k">DEFAULT</span> <span class="k">PRIVILEGES</span>
<span class="k">IN</span> <span class="k">SCHEMA</span> <span class="n">app</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">TABLES</span> <span class="k">TO</span> <span class="n">scraper</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">DEFAULT</span> <span class="k">PRIVILEGES</span>
<span class="k">IN</span> <span class="k">SCHEMA</span> <span class="n">app</span>
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="n">FUNCTIONS</span> <span class="k">TO</span> <span class="n">scraper</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="–æ–±—â–µ–µ-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ">–û–±—â–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</h2>

<p>MVCC</p>

<h2 id="indexes">Indexes</h2>

<p>–¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π: https://habr.com/ru/company/postgrespro/blog/326096/</p>

<p><code class="language-plaintext highlighter-rouge">Create index [concurrently] on table(field) [using gist]</code></p>

<p>–ò–Ω–¥–µ–∫—Å—ã –≤ PostgreSQL ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º. –≠—Ç–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: –ª—é–±–æ–π –∏–Ω–¥–µ–∫—Å –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–Ω–æ–≤–æ –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ. –ò–Ω–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Å–ª—ã—à–∞—Ç—å, —á—Ç–æ –°–£–ë–î –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –±–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤, –ø—Ä–æ—Å—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫, –≤–µ–¥—å –∏–Ω–¥–µ–∫—Å—ã —Å–ª—É–∂–∞—Ç —Ç–∞–∫–∂–µ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏.
–ù—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –∑–∞ —ç—Ç–æ –º—ã –ø–ª–∞—Ç–∏–º —Å–∫–æ—Ä–æ—Å—Ç—å—é –≤—Å—Ç–∞–≤–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É.</p>

<ul>
  <li>Index Scan: –∫–æ–≥–¥–∞ –∏–¥—ë—Ç –ø–æ–∏—Å–∫ –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –ø–æ–ª—è</li>
  <li>Bitmap Index Scan: –∫–æ–≥–¥–∞ –∏–¥—ë—Ç –ø–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º
    <ul>
      <li>–ú–æ–∂–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ—è–≤–∏—Ç—Å—è Recheck Condition, –µ—Å–ª–∏ –±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ –Ω–µ –≤–ª–µ–∑–∞–µ—Ç –≤ work_mem</li>
    </ul>
  </li>
  <li>Index <strong>Only</strong> Scan: –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –≤–µ—Ä–Ω—É—Ç—å, –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –∏–Ω–¥–µ–∫—Å–µ</li>
</ul>

<p>–ö—Ä–æ–º–µ –∏–Ω–¥–µ–∫—Å–∞ –Ω–∞ –ø–æ–ª–µ –≤ postgresql –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å:</p>
<ul>
  <li>—Å–æ—Å—Ç–∞–≤–Ω–æ–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π)</li>
  <li>—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π (—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞–¥ –ø–æ–ª–µ–º –∏–ª–∏ –ø–æ–ª—è–º–∏)</li>
  <li>—á–∞—Å—Ç–∏—á–Ω—ã–π (—Ñ–∏–ª—å—Ç—Ä —É—Å–ª–æ–≤–∏–µ)</li>
</ul>

<p>–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è exclusive lock, –Ω–æ –º–æ–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ –∏ —Ç–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–≤–∞ —á—Ç–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã.</p>

<p>–°–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ pg_am –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫–∏–µ –≤–∏–¥—ã –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ —Å –∫–∞–∫–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ü–æ–¥—Ä–æ–±–µ–µ –æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ç—É—Ç: https://postgrespro.ru/docs/postgresql/9.6/catalogs.html</p>

<h3 id="—Ö—ç—à-–∏–Ω–¥–µ–∫—Å">–•—ç—à-–∏–Ω–¥–µ–∫—Å</h3>

<p>–ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –≤ –∏–Ω–¥–µ–∫—Å –≤—ã—á–∏—Å–ª–∏–º <a href="https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/access/hash/hashfunc.c;hb=HEAD">—Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∫–ª—é—á–∞</a>. –•–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏ –≤ PostgreSQL –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ç–∏–ø integer, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω—É 232 ‚âà 4 –º–∏–ª–ª–∏–∞—Ä–¥–∞ –∑–Ω–∞—á–µ–Ω–∏–π. –ß–∏—Å–ª–æ –∫–æ—Ä–∑–∏–Ω –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ä–∞–≤–Ω–æ –¥–≤—É–º –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—è—Å—å –ø–æ–¥ –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö; –Ω–æ–º–µ—Ä –∫–æ—Ä–∑–∏–Ω—ã –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –ø–æ —Ö–µ—à-–∫–æ–¥—É —Å –ø–æ–º–æ—â—å—é –±–∏—Ç–æ–≤–æ–π –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏. –í —ç—Ç—É –∫–æ—Ä–∑–∏–Ω—É –∏ –ø–æ–ª–æ–∂–∏–º –Ω–∞—à TID.</p>

<p>–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ö–µ—à-–∏–Ω–¥–µ–∫—Å –Ω–µ —É–º–µ–µ—Ç —É–º–µ–Ω—å—à–∞—Ç—å—Å—è –≤ —Ä–∞–∑–º–µ—Ä–µ. –ï—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å —á–∞—Å—Ç—å –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫, –æ–¥–Ω–∞–∂–¥—ã –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–∂–µ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, –∞ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ (VACUUM). –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —É–º–µ–Ω—å—à–∏—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞ ‚Äî –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ —Å –Ω—É–ª—è –∫–æ–º–∞–Ω–¥–æ–π REINDEX –∏–ª–∏ VACUUM FULL.</p>

<h3 id="btree">Btree</h3>

<p>–ò–Ω–¥–µ–∫—Å btree, –æ–Ω –∂–µ B-–¥–µ—Ä–µ–≤–æ, –ø—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å. –ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –¥–ª—è —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ¬´–±–æ–ª—å—à–µ¬ª, ¬´–±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ¬ª, ¬´–º–µ–Ω—å—à–µ¬ª, ¬´–º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ¬ª –∏ ¬´—Ä–∞–≤–Ω–æ¬ª. –ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –∏–Ω–æ–≥–¥–∞ –º–æ–∂–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞—Å –∫ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Å–µ–º–µ–π—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.</p>

<p>–ö–∞–∫ –≤—Å–µ–≥–¥–∞, –∏–Ω–¥–µ–∫—Å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ B-–¥–µ—Ä–µ–≤–∞ —É–ø–∞–∫–æ–≤–∞–Ω—ã –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –í –ª–∏—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö —ç—Ç–∏ –∑–∞–ø–∏—Å–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫–ª—é—á–∏) –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã (TID-—ã); –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –¥–æ—á–µ—Ä–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–Ω–¥–µ–∫—Å–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.</p>

<p>B-–¥–µ—Ä–µ–≤—å—è –æ–±–ª–∞–¥–∞—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–∞–∂–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏:</p>
<ul>
  <li>–û–Ω–∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã, —Ç–æ –µ—Å—Ç—å –ª—é–±—É—é –ª–∏—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ç–¥–µ–ª—è–µ—Ç –æ—Ç –∫–æ—Ä–Ω—è –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —á–∏—Å–ª–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü. –ü–æ—ç—Ç–æ–º—É –ø–æ–∏—Å–∫ –ª—é–±–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –≤—Ä–µ–º—è.</li>
  <li>–û–Ω–∏ —Å–∏–ª—å–Ω–æ –≤–µ—Ç–≤–∏—Å—Ç—ã, —Ç–æ –µ—Å—Ç—å –∫–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, 8 –ö–ë) —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ä–∞–∑—É –º–Ω–æ–≥–æ (—Å–æ—Ç–Ω–∏) TID-–æ–≤. –ó–∞ —Å—á–µ—Ç —ç—Ç–æ–≥–æ –≥–ª—É–±–∏–Ω–∞ B-–¥–µ—Ä–µ–≤—å–µ–≤ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–æ–π; –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –¥–æ 4‚Äì5 –¥–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü.</li>
  <li>–î–∞–Ω–Ω—ã–µ –≤ –∏–Ω–¥–µ–∫—Å–µ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –ø–æ –Ω–µ—É–±—ã–≤–∞–Ω–∏—é (–∫–∞–∫ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏, —Ç–∞–∫ –∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã), –∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–¥–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º —Å–ø–∏—Å–∫–æ–º. –ü–æ—ç—Ç–æ–º—É –ø–æ–ª—É—á–∏—Ç—å —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –º—ã –º–æ–∂–µ–º, –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—Ö–æ–¥—è –ø–æ —Å–ø–∏—Å–∫—É –≤ –æ–¥–Ω—É –∏–ª–∏ –≤ –¥—Ä—É–≥—É—é —Å—Ç–æ—Ä–æ–Ω—É, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—è—Å—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫ –∫–æ—Ä–Ω—é.</li>
</ul>

<h3 id="gist">GiST</h3>

<p>GiST ‚Äî —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –æ—Ç ¬´generalized search tree¬ª. –≠—Ç–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞, —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ b-tree.</p>

<p>–í —á–µ–º –∂–µ —Ä–∞–∑–Ω–∏—Ü–∞? –ò–Ω–¥–µ–∫—Å b-tree –∂–µ—Å—Ç–∫–æ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Å–µ–º–∞–Ω—Ç–∏–∫–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ ¬´–±–æ–ª—å—à–µ¬ª, ¬´–º–µ–Ω—å—à–µ¬ª, ¬´—Ä–∞–≤–Ω–æ¬ª ‚Äî —ç—Ç–æ –≤—Å–µ, –Ω–∞ —á—Ç–æ –æ–Ω —Å–ø–æ—Å–æ–±–µ–Ω (–∑–∞—Ç–æ —Å–ø–æ—Å–æ–±–µ–Ω –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ!). –ù–æ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–∞–∑–∞—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –∏ —Ç–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —ç—Ç–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–æ—Å—Ç–æ –Ω–µ –∏–º–µ—é—Ç —Å–º—ã—Å–ª–∞: –≥–µ–æ–¥–∞–Ω–Ω—ã–µ, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∫–∞—Ä—Ç–∏–Ω–∫–∏.
–ö—Ä–æ–º–µ —É—Å–ª–æ–≤–∏—è –Ω–∞ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤, GiST –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –∏—Å–∫–ª—é—á–∞—é—â–∏–π –∏–Ω–¥–µ–∫—Å.</p>

<p>–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:</p>
<ul>
  <li>R-–¥–µ—Ä–µ–≤–æ –¥–ª—è —Ç–æ—á–µ–∫ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –∏–ª–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤.</li>
  <li>RD-–¥–µ—Ä–µ–≤–æ –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–ò–¥–µ—è RD-–¥–µ—Ä–µ–≤—å–µ–≤ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –≤–º–µ—Å—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –≤–∑—è—Ç—å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ ‚Äî —Ç–æ –µ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ—á–µ—Ä–Ω–∏—Ö –º–Ω–æ–∂–µ—Å—Ç–≤.)</li>
</ul>

<h3 id="sp-gist">SP-GiST</h3>

<p>–í–Ω–∞—á–∞–ª–µ –Ω–µ–º–Ω–æ–≥–æ –æ –Ω–∞–∑–≤–∞–Ω–∏–∏. –°–ª–æ–≤–æ ¬´GiST¬ª –Ω–∞–º–µ–∫–∞–µ—Ç –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Å—Ö–æ–∂–µ—Å—Ç—å —Å –æ–¥–Ω–æ–∏–º–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–æ–º. –°—Ö–æ–∂–µ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å: –∏ —Ç–æ—Ç, –∏ –¥—Ä—É–≥–æ–π ‚Äî generalized search trees, –æ–±–æ–±—â–µ–Ω–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –ø–æ–∏—Å–∫–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∫–∞—Ä–∫–∞—Å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–∞.</p>

<p>¬´SP¬ª —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ space partitioning, —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞. –í —Ä–æ–ª–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —á–∞—Å—Ç–æ –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –º—ã –∏ –ø—Ä–∏–≤—ã–∫–ª–∏ –Ω–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–≤—É–º–µ—Ä–Ω–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å. –ù–æ, –∫–∞–∫ –º—ã —É–≤–∏–¥–∏–º, –∏–º–µ–µ—Ç—Å—è –≤ –≤–∏–¥—É –ª—é–±–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞, –ø–æ —Å—É—Ç–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π.</p>

<p>SP-GiST –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –æ–±–ª–∞—Å—Ç–∏. –í —ç—Ç–æ—Ç –∫–ª–∞—Å—Å –≤—Ö–æ–¥—è—Ç –¥–µ—Ä–µ–≤—å—è –∫–≤–∞–¥—Ä–∞–Ω—Ç–æ–≤ (quadtree), k-–º–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è (k-D tree), –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è (trie).</p>

<h3 id="gin">GIN</h3>

<p>GIN —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ Generalized Inverted Index ‚Äî —ç—Ç–æ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π –æ–±—Ä–∞—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å. –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —è–≤–ª—è—é—Ç—Å—è –∞—Ç–æ–º–∞—Ä–Ω—ã–º–∏, –∞ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –ü—Ä–∏ —ç—Ç–æ–º –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –Ω–µ —Å–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è, –∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã; –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è.</p>

<p>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∏–Ω–¥–µ–∫—Å GIN —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ B-–¥–µ—Ä–µ–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫ –ª–∏—Å—Ç–æ–≤—ã–º –∑–∞–ø–∏—Å—è–º –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–≤—è–∑–∞–Ω—ã B-–¥–µ—Ä–µ–≤—å—è –∏–ª–∏ –ø–ª–æ—Å–∫–∏–µ —Å–ø–∏—Å–∫–∏ TID-–æ–≤.</p>

<h4 id="gist-vs-gin">GiST vs GIN</h4>
<p>–î–ª—è –º–Ω–æ–≥–∏—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∫–ª–∞—Å—Å—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –¥–ª—è GiST, –∏ –¥–ª—è GIN, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å: —á–µ–º –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è? –ü–æ–∂–∞–ª—É–π, —É–∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –≤—ã–≤–æ–¥—ã.</p>

<p>–ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, GIN –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ–∏—Å–∫–∞ —É GiST. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –Ω–µ —á–∞—Å—Ç–æ, –∞ –∏—Å–∫–∞—Ç—å –Ω–∞–¥–æ –±—ã—Å—Ç—Ä–æ ‚Äî —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –≤—ã–±–æ—Ä –ø–∞–¥–µ—Ç –Ω–∞ GIN.</p>

<p>–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ, –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ GIN –º–æ–≥—É—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫–∏. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–∏–¥–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∏ –≤—ã–±–∏—Ä–∞—Ç—å —Ç–æ—Ç, —á—å–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –ª—É—á—à–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã.</p>

<h3 id="brin">BRIN</h3>

<p>–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã —É–∂–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å, –∏–¥–µ—è BRIN –Ω–µ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, –∞ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–≤–µ–¥–æ–º–æ –Ω–µ–Ω—É–∂–Ω—ã—Ö. –≠—Ç–æ –≤—Å–µ–≥–¥–∞ –Ω–µ—Ç–æ—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å: –æ–Ω –≤–æ–æ–±—â–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç TID-–æ–≤ —Ç–∞–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫.
–†–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º. –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∑–æ–Ω—ã (range) —Ä–∞–∑–º–µ—Ä–æ–º –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü (–∏–ª–∏ –±–ª–æ–∫–æ–≤, —á—Ç–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ) ‚Äî –æ—Ç—Å—é–¥–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ: Block Range Index, BRIN. –î–ª—è –∫–∞–∂–¥–æ–π –∑–æ–Ω—ã –≤ –∏–Ω–¥–µ–∫—Å–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å–≤–æ–¥–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω—ã—Ö –≤ —ç—Ç–æ–π –∑–æ–Ω–µ. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–æ –±—ã–≤–∞–µ—Ç –∏ –∏–Ω–∞—á–µ, –∫–∞–∫ –º—ã —É–≤–∏–¥–∏–º –¥–∞–ª—å—à–µ. –ï—Å–ª–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ —É—Å–ª–æ–≤–∏–µ –Ω–∞ —Å—Ç–æ–ª–±–µ—Ü, –∏—Å–∫–æ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω, —Ç–æ –≤—Å—é –∑–æ–Ω—É –º–æ–∂–Ω–æ —Å–º–µ–ª–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å; –µ—Å–ª–∏ –∂–µ –ø–æ–ø–∞–¥–∞—é—Ç ‚Äî –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤–æ –≤—Å–µ—Ö –±–ª–æ–∫–∞—Ö –∑–æ–Ω—ã –ø—Ä–∏–¥–µ—Ç—Å—è –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏ –≤—ã–±—Ä–∞—Ç—å —Å—Ä–µ–¥–∏ –Ω–∏—Ö –ø–æ–¥—Ö–æ–¥—è—â–∏–µ.
–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫–∏‚Ä¶ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ –∫–∞–∫–∏—Ö-—Ç–æ —Å–ª—É—á–∞—è—Ö –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ —Ç–æ–≥–¥–∞ –¥–∏–∞–ø–∞–∑–æ–Ω –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —É–º–µ–Ω—å—à–∏—Ç—å. –ù–æ —á—Ç–æ–±—ã —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –ø—Ä–∏—à–ª–æ—Å—å –±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–æ–Ω–µ, –∞ —ç—Ç–æ –Ω–∞–∫–ª–∞–¥–Ω–æ.</p>

<h3 id="bloom">Bloom</h3>

<p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ñ–∏–ª—å—Ç—Ä –ë–ª—É–º–∞ ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–∞ –º–Ω–æ–∂–µ—Å—Ç–≤—É. –§–∏–ª—å—Ç—Ä –æ—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–µ–Ω, –Ω–æ –¥–æ–ø—É—Å–∫–∞–µ—Ç –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è: –æ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –æ—à–∏–±–∏—Ç—å—Å—è –∏ —Å—á–µ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–º –º–Ω–æ–∂–µ—Å—Ç–≤—É (false positive), –Ω–æ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–µ—Ç –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ, –µ—Å–ª–∏ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –æ–Ω —Ç–∞–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç (false negative).</p>

<p>–§–∏–ª—å—Ç—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –±–∏—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤ (–Ω–∞–∑—ã–≤–∞–µ–º—ã–π —Ç–∞–∫–∂–µ —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π) –¥–ª–∏–Ω–æ–π m –±–∏—Ç, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –Ω—É–ª—è–º–∏. –í—ã–±–∏—Ä–∞—é—Ç—Å—è k —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –ª—é–±–æ–π —ç–ª–µ–º–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤ k –±–∏—Ç–æ–≤ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã. –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ, –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –∫–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö –±–∏—Ç–æ–≤ –≤ –µ–¥–∏–Ω–∏—Ü—É. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –≤—Å–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—É –±–∏—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –µ–¥–∏–Ω–∏—Ü—É ‚Äî —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ; –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±–∏—Ç —Ä–∞–≤–µ–Ω –Ω—É–ª—é ‚Äî —ç–ª–µ–º–µ–Ω—Ç —Ç–æ—á–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.</p>

<h2 id="planner">Planner</h2>

<h3 id="hints">Hints</h3>

<p>Since 9.2:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Increasing the length limit for a varchar or varbit column, or removing the limit altogether, no longer requires a table rewrite. Similarly, increasing the allowable precision of a numeric column, or changing a column from constrained numeric to unconstrained numeric, no longer requires a table rewrite. Table rewrites are also avoided in similar cases involving the interval, timestamp, and timestamptz types.
</code></pre></div></div>

<h3 id="pgstatistics">PgStatistics</h3>

<p>This table (pg_statistic) is, of course, described <a href="http://www.postgresql.org/docs/current/interactive/catalog-pg-statistic.html">the docs</a>. But it is pretty cryptic. Of course, you can find very precise explanation in <a href="http://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/include/catalog/pg_statistic.h">sources</a>, but that‚Äôs not (usually) best solution.</p>

<h2 id="explain">Explain</h2>

<h3 id="bitmap-index-scan">Bitmap index scan</h3>

<p>Let‚Äôs assume your table has 100000 pages (that would be ~ 780MB). Bitmap Index Scan would create a bitmap where there would be one bit for every page in your table. So in this case, we‚Äôd get memory block of 100,000 bits ~ 12.5kB. All these bits would be set to 0. Then Bitmap Index Scan, would set some bits to 1, depending on which page in table might contain row that should be returned.</p>

<h3 id="sort">Sort</h3>

<p>While it is simple, it has some cool logic inside. For starters ‚Äì if memory used for sorting would be more than work_mem, it will switch to using disk based sorting. In explain this is written in sort method.</p>

<h3 id="hashaggregate">HashAggregate</h3>

<p>HashAggregate does something like this: for every row it gets, it finds GROUP BY ‚Äúkey‚Äù (in this case relkind). Then, in hash (associative array, dictionary), puts given row into bucket designated by given key. Now, if you understand it, you should see potential problem: well, what about case when there are millions of rows? The hash will be too big to fit in memory. And here, again, we‚Äôll be using work_mem. If generated hash is too big, it will ‚Äúspill‚Äù to disk (again in the $PGDATA/base/pgsql_tmp).</p>

<h3 id="hash-join">Hash join</h3>

<p>It works like this ‚Äì first Hash Join calls ‚ÄúHash‚Äù, which in turns calls something else (Seq Scan on pg_namespace in our case). Then, Hash makes a memory (or disk, depending on size) hash/associative-array/dictionary with rows from the source, hashed using whatever is used to join the data (in our case, it‚Äôs OID column in pg_namespace).</p>

<h3 id="nested-loop">Nested Loop</h3>

<p>So, the processing looks like this:</p>
<ol>
  <li>Nested Loop runs one side of join, once. Let‚Äôs name it ‚ÄúA‚Äù.</li>
  <li>For every row in ‚ÄúA‚Äù, it runs second operation (let‚Äôs name it ‚ÄúB‚Äù)</li>
  <li>if ‚ÄúB‚Äù didn‚Äôt return any rows ‚Äì data from ‚ÄúA‚Äù is ignored</li>
  <li>if ‚ÄúB‚Äù did return rows, for every row it returned, new row is returned by Nested Loop, based on current row from A, and current row from B</li>
</ol>

<h3 id="merge-join">Merge Join</h3>

<p>The procedure looks like this:</p>
<ol>
  <li>if join column on right side is the same as join column on left side:
    <ul>
      <li>return new joined row, based on current rows on the right and left sides</li>
      <li>get next row from right side (or, if there are no more rows, on left side)</li>
      <li>go to step 1</li>
    </ul>
  </li>
  <li>if join column on right side is ‚Äúsmaller‚Äù than join column on left side:
    <ul>
      <li>get next row from right side (if there are no more rows, finish processing)</li>
      <li>go to step 1</li>
    </ul>
  </li>
  <li>if join column on right side is ‚Äúlarger‚Äù than join column on left side:
    <ul>
      <li>get next row from left side (if there are no more rows, finish processing)</li>
      <li>go to step 1</li>
    </ul>
  </li>
</ol>

<h3 id="materialize">Materialize</h3>

<p>Long story short ‚Äì Materialize gets data from underlying operation and stores it in memory (or partially in memory) so that it can be used faster, or with additional features that underlying operation doesn‚Äôt provide.</p>

<h3 id="unique">Unique</h3>

<p>Removes non-unique data from sorted rows.</p>

<h3 id="append">Append</h3>

<p>Just concatinate plans, when union is used</p>

<h3 id="groupaggregate">GroupAggregate</h3>

<p>Similar to HashAggregate but on set of columns(n).</p>

<h3 id="hashsetop">HashSetOp</h3>

<p>This operation is used by INTERSECT/EXCEPT operations (with optional ‚ÄúALL‚Äù modifier).</p>

<h3 id="cte-scan">CTE Scan</h3>

<p>Same as Materialize, but for window function.</p>

<h2 id="–∏—Å—Ç–æ—á–Ω–∏–∫–∏">–ò—Å—Ç–æ—á–Ω–∏–∫–∏</h2>

<ul>
  <li>–°–µ—Ä–∏—è expain analyze: <a href="https://www.depesz.com/2013/04/16/explaining-the-unexplainable/">1</a>, <a href="https://www.depesz.com/2013/04/27/explaining-the-unexplainable-part-2/">2</a>, <a href="https://www.depesz.com/2013/05/09/explaining-the-unexplainable-part-3/">3</a>, <a href="https://www.depesz.com/2013/05/19/explaining-the-unexplainable-part-4/">4</a>, <a href="https://www.depesz.com/2013/05/30/explaining-the-unexplainable-part-5/">5</a>.</li>
</ul>

    </content>

    
    <side class="backlink">
      <h3 style="margin-bottom: 1em">–û–±—Ä–∞—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h3>
      <div class="backlink-boxes">
        
        
        <div class="backlink-box">
          <a class="internal-link"
            href="/openbox/articles/202305190954/">Queries for pg_stat_statements</a><br>
          <div>TL;DR: –ø–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ pg_stat_statements –≤ PostgresSQL –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
</div>
        </div>
        
        
      </div>
    </side>
    
  </div>
</article>
</main>
      <footer></footer>
    </div>

    <!-- https://github.com/maximevaillancourt/digital-garden-jekyll-template/blob/master/_includes/link-previews.html -->
<!-- That file is not particularly elegant. This will need a refactor at some point. -->
<style>
    content a.internal-link {
        border-color: #8b88e6;
        background-color: #efefff;
    }

    #tooltip-wrapper {
        background: white;
        padding: 1em;
        border: 1px solid #ddd;
        border-radius: 4px;
        overflow: hidden;
        position: absolute;
        width: 400px;
        height: 250px;
        font-size: 0.8em;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        opacity: 0;
        transition: opacity 100ms;
    }

    #tooltip-wrapper:after {
        content: "";
        position: absolute;
        z-index: 1;
        bottom: 0;
        left: 0;
        pointer-events: none;
        background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 1) 90%);
        width: 100%;
        height: 75px;
    }

</style>

<div style="opacity: 0; display: none;" id='tooltip-wrapper'>
    <div id='tooltip-content'>
    </div>
</div>

<iframe style="display: none; height: 0; width: 0;" id='link-preview-iframe' src="">
</iframe>

<script>
    const tooltipContentSelector = "main";
    const tooltipLinksQuery = "main a";

    var opacityTimeout;
    var contentTimeout;
    var transitionDurationMs = 100;

    var iframe = document.getElementById('link-preview-iframe')
    var tooltipWrapper = document.getElementById('tooltip-wrapper')
    var tooltipContent = document.getElementById('tooltip-content')

    function hideTooltip() {
        opacityTimeout = setTimeout(function () {
            tooltipWrapper.style.opacity = 0;
            contentTimeout = setTimeout(function () {
                tooltipContent.innerHTML = '';
                tooltipWrapper.style.display = 'none';
            }, transitionDurationMs + 1);
        }, transitionDurationMs)
    }

    function showTooltip(event) {
        var elem = event.target;
        var elem_props = elem.getClientRects()[elem.getClientRects().length - 1];
        var top = window.pageYOffset || document.documentElement.scrollTop;

        if (event.target.host === window.location.host) {
            iframe.src = event.target.href
            iframe.onload = function () {
                tooltipContentHtml = ''
                tooltipContentHtml += iframe.contentWindow.document.querySelector(
                    tooltipContentSelector
                )?.innerHTML;

                tooltipContent.innerHTML = tooltipContentHtml

                tooltipWrapper.style.display = 'block';
                setTimeout(function () {
                    tooltipWrapper.style.opacity = 1;
                }, 1)
            }

            tooltipWrapper.style.left = elem_props.left - (tooltipWrapper.offsetWidth / 2) + (elem_props.width / 2) + "px";
            if ((window.innerHeight - elem_props.top) < (tooltipWrapper.offsetHeight)) {
                tooltipWrapper.style.top = elem_props.top + top - tooltipWrapper.offsetHeight - 10 + "px";
            } else if ((window.innerHeight - elem_props.top) > (tooltipWrapper.offsetHeight)) {
                tooltipWrapper.style.top = elem_props.top + top + 35 + "px";
            }

            if ((elem_props.left + (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
                tooltipWrapper.style.left = "10px";
            } else if ((document.body.clientWidth - elem_props.left - (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
                tooltipWrapper.style.left = document.body.clientWidth - tooltipWrapper.offsetWidth - 20 + "px";
            }
        }
    }

    function setupListeners(linkElement) {
        linkElement.addEventListener('mouseleave', function (_event) {
            hideTooltip();
        });

        tooltipWrapper.addEventListener('mouseleave', function (_event) {
            hideTooltip();
        });

        linkElement.addEventListener('touchend', function (_event) {
            hideTooltip();
        });

        tooltipWrapper.addEventListener('touchend', function (_event) {
            hideTooltip();
        });

        linkElement.addEventListener('mouseenter', function (event) {
            clearTimeout(opacityTimeout);
            clearTimeout(contentTimeout);
            showTooltip(event);
        });

        tooltipWrapper.addEventListener('mouseenter', function (event) {
            clearTimeout(opacityTimeout);
            clearTimeout(contentTimeout);
        });
    }

    document.querySelectorAll(tooltipLinksQuery).forEach(setupListeners);
</script>

    <script src="https://unpkg.com/mermaid@8.9.3/dist/mermaid.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    mermaid.initialize({
      startOnLoad:true,
      theme: "default",
    });
    window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
  }, false);
</script>
    
<!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "7507913639b540edbde55792995b90d8"}'></script><!-- End Cloudflare Web Analytics -->

  </body>
</html>
