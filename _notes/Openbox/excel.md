---
{"dg-publish":true,"date":"2022-01-16T11:19:50+03:00","modified_at":"2022-06-02T08:45:25+03:00","permalink":"/excel/","dgHomeLink":false,"dgPassFrontmatter":true}
---


Excel - это оцифрованные гроссбухи с приправленными сверху формулами и аддонами. Если финансовые люди говорят про эксельку, то они как правило имеют в виду Microsoft Excel.
С другой стороны, более удобной альтернативой являются гуглотаблицы, потому что они бесплатные и ими можно делиться для совместного пользования и редактирования без общих дисков. 
inb4 Не рассказывайте про Office 365, _пожалуйста_.
Большинство функций пересекаются и там, и там, и есть третий брат-дурак под названием LibreOffice Calc с форматом ods, который при этом умеет работать с форматами Microsoft Excel.

Основные отличия google таблиц и Excel:
- по другому пишутся макросы: в случае таблица - это урезанный js, в Excel - visual basic for application.
- есть функции, которые делают одно и тоже, но называются по разному.

Здесь и далее всё буду писать про гуглотаблицы, потому что ими пользуюсь чаще.

## Про диапазоны

Прежде чем начать рассказывать про функции, большинство из перечисленных будет работать с диапазонами данных из таблицы, поэтому вот что нужно знать:
- Самое базовое, что знак `$` перед числом или цифрой делает так, чтобы при копирование формула указывала на ту же самую строку/столбец/ячейку.
- Необязательно указывать весь диапазон B1:B100, можно указать весь столбец без чисел `B:B` или только начало `B2:B`.
- Если вам необходимо взять диапазон с другой страницы, то используется имя через `!`, а в случае пробелов берёться в кавычки: `"Вкладка данных"!B2:B`.
- Если же данные находятся совсем в другом файле, то можно через функцию `ImportRange` вставить в текущую табличку, а дальше уже обращаться как в предыдущем пункте.

## Про полезные функции

Забудем про стандартные sum, avg, count, которые уже автоматом отображаются в случае выделения диапазона. Расположение в этом списке не означает полезность, скорее просто в каком порядке вспоминал:
- `Sumif`/`Sumifs` - просуммировать значения из столбца по условию другого столбца. Соответственно, аналогичные есть и для всех остальных аггрегатов.
- `Unique` - выбрать из диапазона только уникальные значения.
- `Hlookup`/`Vlookup` - найти значение по ключу из другого диапазона. Эти функции могут выводить только из столбцов правее от ключа по которому ищем, поэтому проектируете положение идентификаторов как можно левее.
- `Filter` - вывести нужны строчки под условия, в отличии от Hlookup/Vlookup не имеет ограничений по поиску.
- `Query` - это такой SQL поверх какой-то таблички. Если уж вы совсем не хотите создавать сводные таблицы, то можно быстро написать `select col1, sum(col2) where col2 > 0 group by col1`. Проблема только в том, что если в условие надо добавить что-то из параметров, то делать это приходиться через склеивание строк.
- `ImportXML` - подтянуть ссылку и взять XPath, что позволяет парсить сайты по ссылке и доставать нужные элементы. Если вы работаете напрямую с API, то можно использовать функции importjson и request.
- `Sparklines` - нарисовать график в ячейке. Прикольно выглядит для всех трекеров привычек, если вы следите за пивом в день или количеством книг.

Периодически функции выше могут выдавать ошибки на пустые значения или если некорректные данные, для этого в языках программирования есть if'чики, и тут они тоже есть.
А вот чтобы было что проверять им в пару стоят всякие функции начинающиеся на IS, например:
- `Isblank` - проверить, что ячейка пустая.
- `Isna` - проверить, что в итоге формулы мы получили несуществующие данные, например такой результат может вернуть VLOOKUP.
- `Iserror` - проверить, что формула которая написана даёт ошибку.

Кроме того, в гуглотаблицах есть много возможностей использовать их другие сервисы, например:
- `Googlefinance` - получить стоимость акций по названию.
- `Googletranslate` - перевести строку с одного языка на другой.

Надеюсь, что сможете найти ещё больше полезного в их [доке](https://support.google.com/docs/table/25273).

## Про оформление

- Будет звучать контринтуитивно, но таблицы лучше без ячеек, поэтому можно их полностью выключить через пункт `View->Gridlines`. А вот уже потом в том месте где сделали таблицу, уже закрасить ячейки так как будет удобно. Таким образом можно сделать несколько данных, в том числе и сводных таблиц, рядом друг с другом для наглядности.
- Всякие итого и промежуточные суммы удобнее делать более крупным шрифтом, для того чтобы быстрее их найти.
- Страйтесь не объединять ячейки, потому что всякие формулы могу поехать при/после объединения.
- Если вам нужно скрыть столбик (например, план/факт) вместо скрытия лучше сделать группировку, чтобы было видно плюсик напротив столбца и что его можно развернуть.
- Условное форматирование наше всё: подсветить где самые большие/маленькие числа, найти пропуски, да что угодно.
- При правом клике на ячейке можно обнаружить опцию "проверка данных", с помощью которой можно сделать дропдаун для выбора из списка значений.
- В справке можно вбить что-то человечьим языком, чтобы не искать по вкладкам. Хотя почему не впилили `command pallete`, как во всех редакторах кода непонятно.
